---
title: "Enggano Impact Questionnaires Results"
author: "Gede Primahadi W. Rajeg, Charlotte Hemmings, Engga Zakaria Sangian"
format:
  pdf:
    message: false
    toc: true
    warning: false
    fig-width: 6
    fig-asp: 0.618
    fig-dpi: 300
    fig-align: "center"
    number-sections: true
    fig-pos: "H"
    echo: false
    geometry:
      - top=1in
      - left=1in
      - right=1in
      - bottom=1in
    
  html:
    code-fold: true
    code-block-border-left: "#31BAE9"
    code-block-bg: "#F8F9F9"
    message: false
    toc: true
    number-sections: true
    warning: false
    smooth-scroll: true
    fig-width: 6
    fig-asp: 0.618
    fig-dpi: 300
    fig-align: "center"
editor: visual
date: 2025-06-23
date-modified: now
---

# Preface

This is a Quarto report for the results of the Enggano Impact Questionnaires collected in Enggano Island by Engga Zakaria Sangian.

```{r setup}
#| message: false
#| warning: false

# a setup chunk
library(likert)
library(grid)
source("pre-processing.R") # all loading the tidyverse
```

## Metadata Question No. 4

It asks whether respondents are (i) teachers (in elementary school \[*SD*\], junior high school \[*SMP*\], or senior high school \[*SMA*\], or (ii) non-teachers (*BUKAN GURU*) (see @fig-q1). Numbers in brackets are raw counts.

```{r}
#| label: fig-q1
#| fig-cap: "Distribution of Teachers vs. Non-Teachers for Metada Question no. 4"

q1 <- quiz |> 
  select(mengajar = `4. Mengajar di tingkat?`) |> 
  mutate(mengajar1 = if_else(str_detect(mengajar, "^(BUKAN|^Pegawai)"), "BUKAN GURU", mengajar)) |> 
  mutate(mengajar1 = str_split(mengajar1, "\\, ")) |> 
  unnest_longer(mengajar1)

q1_count <- q1 |> 
  mutate(mengajar2 = "non-teacher",
         mengajar2 = replace(mengajar2, mengajar1 == "SD", "elementary school teacher"),
         mengajar2 = replace(mengajar2, mengajar1 == "SMP", "junior high school teacher"),
         mengajar2 = replace(mengajar2, mengajar1 == "SMA", "senior high school teacher")) |> 
  mutate(mengajar2 = factor(mengajar2, levels = c("elementary school teacher",
                                                  "junior high school teacher",
                                                  "senior high school teacher",
                                                  "non-teacher"))) |> 
  count(mengajar2) |> 
  mutate(perc = round(n/sum(n)*100, 1))

q1_count |> 
  ggplot(aes(x = mengajar2, y = n)) + 
  geom_col() +
  labs(x = "Is teacher? At which level?",
       y = "frequency") +
  geom_text(aes(label = str_c(perc, "% (", n, ")", sep = "")),
            colour = "white",
            vjust = 1.5,
            size = 3) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))
```

# Questions about Textbooks

## Main Question no. 1

This question asks whether the Enggano language has ever been taught in class before the publication of the textbooks for Junior High and Elementary School (@fig-q5)

```{r}
#| label: fig-q5
#| fig-cap: "Responses for Question no. 1"

q5 <- quiz_chr |> 
  filter(str_detect(question, "^5")) |> 
  count(mengajar2, mengajar3, response) |> 
  mutate(response = if_else(response == "Ya", "Yes", "No"),
         response = factor(response, levels = c("Yes", "No"))) |> 
  mutate(perc = round(n/sum(n)*100, 1))

ggplot(q5, aes(x = mengajar2, y = n, fill = response)) +
  geom_col(position = "dodge") +
  facet_wrap(~mengajar3, scales = "free_x") +
  geom_text(aes(label = str_c(perc, "%\n(", n, ")", sep = "")),
            position = position_dodge(.9),
            vjust = -.25,
            size = 3) +
  theme_bw() +
  theme(legend.position = "top",
        axis.text.x = element_text(angle = 45,
                                   hjust = 1,
                                   size = 8)) +
  scale_y_continuous(limits = c(0, 14), breaks = c(2, 6, 10, 14), minor_breaks = NULL) +
  labs(x = NULL,
       y = "frequency",
       caption = "Has Enggano been taught before the production of the textbooks?")
```

## Main Question no. 2

The question asked whether the Enggano language subject is compulsory in the curriculum today (@fig-q6) This question could also be interpreted by the respondents as Enggano should be a formally/regulated compulsory subject. There is an information that the local/district level government instructs for the teaching of the language at school but that has not been formalised as a written regulation.

```{r}
#| label: fig-q6
#| fig-cap: "Responses for Question no. 2"

q6 <- quiz_chr |> 
  filter(str_detect(question, "^6")) |> 
  count(mengajar2, mengajar3, response) |> 
  mutate(response = if_else(response == "Ya", "Yes", "No"),
         response = factor(response, levels = c("Yes", "No"))) |> 
  mutate(perc = round(n/sum(n)*100, 1))

ggplot(q6, aes(x = mengajar2, y = n, fill = response)) +
  geom_col(position = "dodge") +
  geom_text(aes(label = str_c(perc, "% (", n, ")", sep = "")),
            position = position_dodge(.9),
            vjust = -.25,
            size = 3) +
  theme_bw() +
  facet_wrap(~mengajar3, scales = "free_x") +
  theme(legend.position = "top",
        axis.text.x = element_text(angle = 45,
                                   hjust = 1,
                                   size = 8)) +
  scale_y_continuous(limits = c(0, 12), breaks = c(2, 6, 10, 14), 
                     minor_breaks = NULL) +
  labs(x = NULL,
       y = "frequency",
       caption = "Is Enggano a compulsory subject in the curriculum?")

```

## Main Question no. 3 {#sec-q3}

We ask whether the textbooks for each school level (Junior High and Elementary levels) have ever been used in class since we released them in January 2025. We ask respondents to be honest if the books have never been used (see @fig-q7)

```{r}
#| label: fig-q7
#| fig-cap: "Responses for Question no. 3"

q7 <- quiz_chr |> 
  filter(str_detect(question, "^7")) |> 
  count(mengajar2, mengajar3, response) |> 
  mutate(response = if_else(response == "ya, sudah pernah", "Yes", "Never"),
         response = factor(response, levels = c("Yes", "Never"))) |> 
  mutate(perc = round(n/sum(n)*100, 1))

ggplot(q7, aes(x = mengajar2, y = n, fill = response)) +
  geom_col(position = "dodge") +
  geom_text(aes(label = str_c(perc, "% (", n, ")", sep = "")),
            position = position_dodge(.9),
            vjust = -.25,
            size = 3) +
  theme_bw() +
  facet_wrap(~mengajar3, scales = "free_x") +
  theme(legend.position = "top",
        axis.text.x = element_text(angle = 45,
                                   hjust = 1,
                                   size = 8)) +
  scale_y_continuous(limits = c(0, 12), breaks = c(2, 6, 10, 14), 
                     minor_breaks = NULL) +
  labs(x = NULL,
       y = "frequency",
       caption = "Have the produced textbooks been used in classroom teaching?")
```

## Main Question no. 4

When in @sec-q3 the respondents answered "**Never (used the textbook in class)**", or when they are not teachers, but have seen the contents of the book, we asked them to give an impression of how difficult it seems to use the primary and/or junior high school book, on the 5-point Likert scale. The point 1 means 'very difficult' up to point 5 'very easy'. We can interpret the point 3 as intermediate/neutral impression. Below, we also provide an example of interpreting this Likert-scale bar plots (see @fig-q8) generated using the R package `likert` and `grid`, which can be useful for other same kind of plots.

```{r}
#| fig.width: 9
#| label: fig-q8
#| fig-cap: "Rating results for Question no. 4"

q8 <- quiz_dbl |> 
  filter(str_detect(question, "^8")) |> 
  mutate(response = factor(response),
         response = factor(response, levels = c("1", levels(response)))) |> 
  select(mengajar2, 
         mengajar3, 
         `How difficult it seems to use the textbooks in class?` = response)

q8_count <- q8 |> 
  group_by(mengajar2) |> 
  filter(!is.na(`How difficult it seems to use the textbooks in class?`)) |> 
  count(`How difficult it seems to use the textbooks in class?`) |> 
  mutate(perc = round(n/sum(n)*100, 1)) |> 
  rename(quest = `How difficult it seems to use the textbooks in class?`)

q8_resp <- as.data.frame(q8[,3])
q8_resp_lik <- likert::likert(q8_resp, grouping = q8$mengajar2, nlevels = )
plot(q8_resp_lik, include.histogram = TRUE, include.center = TRUE,
     plot.percents = TRUE)
```

The right panel shows the number of missing (non-answered) responses (maroon) and of completed responses. The left panel shows the distribution of the Likert responses by respondents. Here is an example to interpret the left graph. Take the `non-teacher` response. The `{r} round(q8_resp_lik$results[q8_resp_lik$results$Group == "non-teacher", "2"])`% on the left indicates the cumulative proportion of respondents choosing point 2. So, for this group of respondents, the textbooks appear to be difficult to use, because there are only `{r} round(q8_resp_lik$results[q8_resp_lik$results$Group == "non-teacher", "5"])`% responses capturing point 5 ('very easy'). On the contrary, for the `elementary school teacher`, the impression is reverse whereby cumulatively (up to `{r} round(sum(q8_resp_lik$results[q8_resp_lik$results$Group == "elementary school teacher", c("4", "5")]))`%), this group perceives the textbooks to be relatively easy to use (because selecting points 4 and 5). @tbl-q8 provides the raw counts for @fig-q8.

```{r}
#| tbl-cap: "Counts of the rating in Question 4"
#| label: tbl-q8
#| warning: false
#| message: false

q8_count |> 
  rename(group = mengajar2,
         rating_scale = quest,
         no_of_voter = n,
         percentage = perc) |> 
  knitr::kable()
```

## Main Question no. 5

to be worked on... as this is an open comments

## Main Question no. 6 {#sec-q6}

When in @sec-q3 the respondents answered "Yes" that they have used the textbooks in their classes, we asked them to rate (on the 5-point scale) how difficult it would be for the teacher to teach the material in the textbooks. The interpretation is the same, point 1 is very difficult and point 5 is very easy (see @fig-q9).

```{r}
#| fig.width: 9
#| label: fig-q9
#| fig-cap: "Rating results for Question no. 6"

q9 <- quiz_dbl |> 
  filter(str_detect(question, "^9")) |> 
  mutate(response = factor(response),
         response = factor(response, levels = c("1", levels(response)))) |> 
  select(mengajar2, 
         mengajar3, 
         `How difficult it seems to use the textbooks in class?` = response)

q9_count <- q9 |> 
  group_by(mengajar2) |> 
  filter(!is.na(`How difficult it seems to use the textbooks in class?`)) |> 
  count(`How difficult it seems to use the textbooks in class?`) |> 
  mutate(perc = round(n/sum(n)*100, 1)) |> 
  rename(quest = `How difficult it seems to use the textbooks in class?`)

q9_resp <- as.data.frame(q9[,3])
q9_resp_lik <- likert::likert(q9_resp, grouping = q9$mengajar2, nlevels = )
plot(q9_resp_lik, include.histogram = TRUE, include.center = TRUE,
     plot.percents = TRUE)
```

Note that the `{r} pull(filter(q9_count, mengajar2 == "non-teacher"), perc)` % for the rather neutral scale (point 3) in the `non-teacher` group is represented by just a single respondent. The raw counts are shown in @tbl-q9.

```{r}
#| tbl-cap: "Counts of the rating in Question 6"
#| label: tbl-q9
#| warning: false
#| message: false

q9_count |> 
  rename(group = mengajar2,
         rating_scale = quest,
         no_of_voter = n,
         percentage = perc) |> 
  knitr::kable()
```

## Main Question no. 7 {#sec-q10}

This is a leading, Boolean (yes-no) question about any difficult parts of the textbooks for the teachers to teach. Options regarding which parts are provided in @sec-q11.

```{r}
#| label: fig-q10
#| fig-cap: "Responses for Question no. 7"

q10 <- quiz_chr |> 
  filter(str_detect(question, "^10")) |> 
  count(mengajar2, mengajar3, response) |> 
  mutate(response = if_else(response == "Ya, ada bagian yang sulit", "Yes, there are certain difficult parts", "None"),
         response = factor(response, levels = c("Yes, there are certain difficult parts", "None"))) |> 
  mutate(perc = round(n/sum(n)*100, 1))

q10 |> 
  ggplot(aes(x = mengajar2, y = n, fill = response)) +
  geom_col(position = "dodge") +
  geom_text(aes(label = str_c(perc, "% (", n, ")", sep = "")),
            position = position_dodge(.9),
            vjust = -0.35,
            size = 3) +
  theme_bw() +
  facet_wrap(~mengajar3, scales = "free_x") +
  theme(legend.position = "top",
        axis.text.x = element_text(angle = 45,
                                   hjust = 1,
                                   size = 8)) +
  scale_y_continuous(limits = c(0, 18), breaks = c(2, 6, 10, 14, 18), 
                     minor_breaks = NULL) +
  labs(x = NULL,
       y = "frequency",
       caption = "Are there certain parts of the textbooks that teachers find difficult to teach?")
```

## Main Question no. 8 {#sec-q11}

This question is a follow-up for the question in @sec-q10. It asks respondents to multi-choose from a pre-determined list, with an option to add "others", which parts they find difficult to teach (@fig-q11).

```{r}
#| fig-asp: 0.85
#| label: fig-q11
#| fig-cap: "Responses for Question no. 8"

q11 <- quiz_chr |> 
  filter(str_detect(question, "^11")) |> 
  mutate(response = str_split(response, ", ")) |> 
  unnest_longer(response) |> 
  count(mengajar2, mengajar3, response)
q11_resp <- tribble(~main_cat, ~response, ~english,
                    TRUE, "berbicara/pelafalan bahasa Enggano", "speaking/pronunciation",
                    TRUE, "kosakata bahasa Enggano", "vocabulary",
                    TRUE, "membaca bahasa Enggano", "reading",
                    TRUE, "menulis bahasa Enggano", "writing/orthography",
                    TRUE,"tatabahasa bahasa Enggano", "grammar",
                    FALSE, "Untuk penulisan tanda baca dan pembaca memang masih harus di singkronkan antra para pengajar agar mudah memaparkan dan mengajarkan pada para siswa", "We still need to syncronise the understanding of the readers with the orthography/spelling. That way, it would be easier between teachers to explain and teach the orthography to the students.")
q11 <- left_join(q11, q11_resp, by = join_by("response")) |> 
  mutate(main_cat = replace(main_cat, is.na(main_cat), TRUE)) |> 
  filter(main_cat) |> 
  mutate(perc = round(n/sum(n)*100, 1))

q11 |> 
  ggplot(aes(x = mengajar2, y = n, fill = english)) +
  geom_col(position = "dodge") +
  geom_text(aes(label = str_c(perc, "% (", n, ")", sep = "")),
            position = position_dodge(.9),
            hjust = -0.15,
            size = 2.25, fontface = "bold") +
  theme_bw() +
  facet_wrap(~mengajar3, scales = "free_y") +
  theme(legend.position = "top",
        legend.text = element_text(size = 8),
        axis.text.y = element_text(size = 8)) +
  scale_y_continuous(limits = c(0, 18), breaks = c(2, 6, 10, 14, 18), 
                     minor_breaks = NULL) +
  coord_flip() +
  labs(x = NULL,
       y = "frequency",
       fill = "response",
       caption = "Which parts of the textbooks are difficult to teach?")
```

There is one respondent choosing "others" and providing a comment regarding orthography as follows:

> Indonesian: "*Untuk penulisan tanda baca dan pembaca memang masih harus di singkronkan antra para pengajar agar mudah memaparkan dan mengajarkan pada para siswa*"
>
> English: "We still need to syncronise the understanding of the readers with the orthography/spelling. That way, it would be easier between teachers to explain and teach the orthography to the students."

## Main Question no. 9

If in question 7 (@sec-q10) you answered ‘Yes’, there are certain difficult parts of the textbook to teach, please provide comments regarding solutions that you can think of to reduce these difficulties.

... TO DO ...

# Questions for Digital and Print Dictionaries
